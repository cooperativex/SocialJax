input_obs_shape (896, 11, 11, 19)
/root/miniconda3/envs/jax/lib/python3.10/site-packages/jax/_src/ops/scatter.py:96: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=int32 to dtype=int16 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
/root/miniconda3/envs/jax/lib/python3.10/site-packages/jax/_src/ops/scatter.py:96: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=int32 to dtype=int16 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
Error executing job with overrides: []
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py", line 563, in main
    single_run(config)
  File "/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py", line 420, in single_run
    out = jax.vmap(train_jit)(rngs)
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 16757954760 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:         8B
              constant allocation:     8.4KiB
        maybe_live_out allocation:   11.69MiB
     preallocated temp allocation:   15.61GiB
  preallocated temp fragmentation:   26.69MiB (0.17%)
                 total allocation:   15.62GiB
              total fragmentation:   27.06MiB (0.17%)
Peak buffers:
	Buffer 1:
		Size: 7.67GiB
		Operator: op_name="jit(train)/jit(main)/while/body/while[cond_nconsts=0 body_nconsts=0]" source_file="/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py" source_line=375
		XLA Label: fusion
		Shape: f32[1000,1,896,11,11,19]
		==========================

	Buffer 2:
		Size: 7.67GiB
		Operator: op_name="jit(train)/jit(main)/while/body/while/body/jit(_take)/select_n" source_file="/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py" source_line=360
		XLA Label: fusion
		Shape: f32[1,1,896000,19,11,11]
		==========================

	Buffer 3:
		Size: 55.50MiB
		Operator: op_name="jit(train)/jit(main)/while/body/while/body/while/body/transpose(jvp(ActorCritic))/CNN_0/Conv_2/conv_general_dilated[window_strides=(1, 1) padding=((1, 1), (1, 1)) lhs_dilation=(1, 1) rhs_dilation=(1, 1) dimension_numbers=ConvDimensionNumbers(lhs_spec=(3, 0, 1, 2), rhs_spec=(3, 0, 1, 2), out_spec=(2, 3, 0, 1)) feature_group_count=1 batch_group_count=1 precision=None preferred_element_type=None]" source_file="/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py" source_line=50
		XLA Label: custom-call
		Shape: u8[58200080]
		==========================

	Buffer 4:
		Size: 26.47MiB
		Operator: op_name="jit(train)/jit(main)/while/body/while/body/while/body/transpose(jvp(ActorCritic))/CNN_0/select_n" source_file="/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py" source_line=56
		XLA Label: fusion
		Shape: f32[1,1792,32,11,11]
		==========================

	Buffer 5:
		Size: 26.47MiB
		Operator: op_name="jit(train)/jit(main)/while/body/while/body/while/body/jvp(ActorCritic)/CNN_0/jit(relu)/max" source_file="/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py" source_line=42 deduplicated_name="fusion.364"
		XLA Label: fusion
		Shape: f32[1792,32,11,11]
		==========================

	Buffer 6:
		Size: 26.47MiB
		Operator: op_name="jit(train)/jit(main)/while/body/while/body/while/body/jvp(ActorCritic)/CNN_0/Conv_1/conv_general_dilated[window_strides=(1, 1) padding=((1, 1), (1, 1)) lhs_dilation=(1, 1) rhs_dilation=(1, 1) dimension_numbers=ConvDimensionNumbers(lhs_spec=(0, 3, 1, 2), rhs_spec=(3, 2, 0, 1), out_spec=(0, 3, 1, 2)) feature_group_count=1 batch_group_count=1 precision=None preferred_element_type=None]" source_file="/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py" source_line=43
		XLA Label: custom-call
		Shape: f32[1792,32,11,11]
		==========================

	Buffer 7:
		Size: 26.47MiB
		Operator: op_name="jit(train)/jit(main)/while/body/while/body/while/body/jvp(ActorCritic)/CNN_0/jit(relu)/max" source_file="/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py" source_line=42 deduplicated_name="fusion.364"
		XLA Label: fusion
		Shape: f32[1792,32,11,11]
		==========================

	Buffer 8:
		Size: 26.47MiB
		Operator: op_name="jit(train)/jit(main)/while/body/while/body/while/body/jvp(ActorCritic)/CNN_0/Conv_0/conv_general_dilated[window_strides=(1, 1) padding=((2, 2), (2, 2)) lhs_dilation=(1, 1) rhs_dilation=(1, 1) dimension_numbers=ConvDimensionNumbers(lhs_spec=(0, 3, 1, 2), rhs_spec=(3, 2, 0, 1), out_spec=(0, 3, 1, 2)) feature_group_count=1 batch_group_count=1 precision=None preferred_element_type=None]" source_file="/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py" source_line=36
		XLA Label: custom-call
		Shape: f32[1792,32,11,11]
		==========================

	Buffer 9:
		Size: 15.72MiB
		Operator: op_name="jit(train)/jit(main)/while/body/while/body/while/body/dynamic_slice[slice_sizes=(1, 1, 1792, 11, 11, 19)]" source_file="/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py" source_line=368
		XLA Label: fusion
		Shape: f32[1,1,1792,19,11,11]
		==========================

	Buffer 10:
		Size: 7.86MiB
		Operator: op_name="jit(train)/jit(main)/while/body/while/body/vmap(jit(step))/jit(step)/select_n" source_file="/root/autodl-tmp/SocialJaxProject/socialjax/environments/multi_agent_env.py" source_line=66
		XLA Label: fusion
		Shape: f32[1,128,7,11,11,19]
		==========================

	Buffer 11:
		Size: 3.42MiB
		Operator: op_name="jit(train)/jit(main)/while/body/while/body/jit(_take)/select_n" source_file="/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py" source_line=360
		XLA Label: fusion
		Shape: f32[1,896000]
		==========================

	Buffer 12:
		Size: 3.42MiB
		Operator: op_name="jit(train)/jit(main)/while/body/while/body/jit(_take)/select_n" source_file="/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py" source_line=360
		XLA Label: fusion
		Shape: f32[1,896000]
		==========================

	Buffer 13:
		Size: 3.42MiB
		Operator: op_name="jit(train)/jit(main)/while/body/while/body/jit(_take)/select_n" source_file="/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py" source_line=360
		XLA Label: fusion
		Shape: f32[1,896000]
		==========================

	Buffer 14:
		Size: 3.42MiB
		Operator: op_name="jit(train)/jit(main)/while/body/while/body/jit(_take)/select_n" source_file="/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py" source_line=360
		XLA Label: fusion
		Shape: f32[1,896000]
		==========================

	Buffer 15:
		Size: 3.42MiB
		Operator: op_name="jit(train)/jit(main)/while/body/while/body/jit(_take)/select_n" source_file="/root/autodl-tmp/SocialJaxProject/algothrims/IPPO/ippo_cnn_cleanup.py" source_line=360
		XLA Label: fusion
		Shape: s32[1,896000]
		==========================



Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
